<!DOCTYPE html>
<html>
  <head>
    <meta name="description" content="inchworms RGSoC">
    <meta name="keywords" content="inchworms, rails girls, summer of code, open source, sinatra, farm subsidy">
    <meta name="author" content="inchworms_">
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="alternate" type="application/rss+xml" title="inchworms" href="http://inchworms.net/blog/feed.xml">
    <link rel="shortcut icon" href="/faviconStatic.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>inch by inch</title>
    <script type="text/javascript" src="/javascripts/d3.v3.js">
    </script>
    <!-- <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?2.1.3"></script> -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <a href="/blog" class="">
          <img src="http://25.media.tumblr.com/aab70fec3abd0a9a6b9f1803621aabc0/tumblr_mn2s5hgPpX1qlpk58o1_400.gif" alt="inchworm" height="84" width="100" style="position:relative; top:5px; float:right;">   
          <h1>inchworms</h1></a>
          <h2>Summer of Coding, one inch at a time...</h2>
              
        </header>
   
        <section id="main_content">
            <!-- This loops through the paginated posts -->

  <h1><a href="/blog/2013-08-22-berlin-map">Berlin map</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Thu 22 August, 2013, 17:00</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Berlin map" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>There are more than just a programming issue when you want to draw a map with d3. It took literally half a day to find a working Berlin map. </p>

<p><img src="/images/not_working_json.png" alt="berlin" style="width: 600px;"/>
<strong>Not working json</strong>
<p></p>
Then I came across that <a href="https://github.com/m-hoerz/berlin-shapes">github account</a> with a perfectly working map with the districs already in geojson format. Just what I was looking for.</p>

<p><img src="/images/working_json.png" alt="berlin" style="width: 600px;"/>
<strong>working json</strong></p>

<p>Isn&#39;t it gorgeous? And look at the colors!
Anyway then I made a choropleth map out of it and finally (took me half a day and a movie-evening with friend(there were complaing I wasn&#39;t watching)) got bars that are transforming from the BOTTOM to the top like normal bars do and not from the top to bottom. <s>And the number of the population that are supposed to be on every bar is not there, although its on my localhost, argggggg! Just imagine they are there.</s>Resolved. Thanks to Matt!</p>

<div id="geo_mapping_berlin" style="height: 650px;" ></div>

<script type="text/javascript">
(function() {
      var w = 800;
      var h = 650;

        //Create SVG element
      var svg = d3.select("#geo_mapping_berlin")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

      var color = d3.scale.quantize()
                .range(["rgb(255,247,188)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(153,52,4)","rgb(102,37,6)"]);

      d3.csv("/data/berlin_population.csv", function(data) {

        var yScale = d3.scale.linear()
          .domain([d3.min(data, function(d) { return d.population; }), d3.max(data, function(d) { return d.population; }) ])
          .range([20, h/3.5]);
          // console.log(yScale(2))

        //Set input domain for color scale
        color.domain([
          d3.min(data, function(d) { return d.population; }), 
          d3.max(data, function(d) { return d.population; })
        ]);

        d3.json("/data/berlin.json", function(json) {
          //Merge the ag. data and GeoJSON
          //Loop through once for each ag. data value
          for (var i = 0; i < data.length; i++) {

            //Grab state name
            var dataDistrict = data[i].district;

            //Grab data value, and convert from string to float
            var dataPopulation = parseFloat(data[i].population);
            var dataLat = parseFloat(data[i].lat);
            var dataLon = parseFloat(data[i].lon);
        
            //Find the corresponding state inside the GeoJSON
            for (var j = 0; j < json.features.length; j++) {
              var jsonDistrict = json.features[j].properties.Name;
              if (dataDistrict == jsonDistrict) {
                //Copy the data Population into the JSON
                json.features[j].properties.population = dataPopulation;
                json.features[j].properties.lat = dataLat;
                json.features[j].properties.lon = dataLon;

                //Stop looking through the JSON
                break;
                }
              }
            }

          var center = d3.geo.centroid(json);
          
          //Tooltip div added
          var div_tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

          //Define map projection
          var projection = d3.geo.mercator()
                .center(center)
                .scale([350000])
                .translate([w/2, h/2]);

          //Define path generator
          var path = d3.geo.path()
                   .projection(projection);

          svg.selectAll("path")
            .data(json.features)
            .enter()
            .append("path")
            .attr("d", path)
            .style("stroke", 'white')
            .style("stroke-width", 2)
            .style("fill", function(d) {
              //Get data value
              var population = d.properties.population;
              
              if (population) {
                //If value exists…
                return color(population);
              } else {
                //If value is undefined…
                return "#ccc";
              }
            })
            .on("mouseover", function(d) {
              d3.select(this).style("stroke", "white").style("stroke-width", 5)
              div_tooltip
                .transition()
                .duration(200)
                .style("opacity", .9);
              div_tooltip
                .html("<b>" + d.properties.Name + "</b></br> Population:" + d.properties.population)
                .style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY - 28) + "px");
              number
                .text(d.properties.population)
                .attr("x", function() {
                  return (projection([d.properties.lon, d.properties.lat])[0]) + "px";
                  })
                .attr("y", function() {
                  return (projection([d.properties.lon, d.properties.lat])[1]) + "px";
                  })
              number
                .transition()
                .duration(600)
                .attr("x", function() {
                  return (projection([d.properties.lon, d.properties.lat])[0]) + "px";
                  })
                .attr("y", function() {
                  return (projection([d.properties.lon, d.properties.lat])[1]) - yScale(d.properties.population) - 1 + "px";
                  });
              rectangle
                .attr("x", function() {
                  return (projection([d.properties.lon, d.properties.lat])[0]);
                  })
                .attr("y", function() {
                  return (projection([d.properties.lon, d.properties.lat])[1])
                  });
              rectangle
                .attr("height", 0)
                .transition()
                .duration(600)
                .attr("height", function() {
                  return yScale(d.properties.population);
                  })
                .attr("y", function() {
                  return (projection([d.properties.lon, d.properties.lat])[1]) - yScale(d.properties.population);
                  })
                })
            .on("mouseout", function(d) {
              div_tooltip
                .transition()
                .duration(500)
                .style("opacity", 0);
              d3.select(this)
                .style("stroke", "white")
                .style("stroke-width", 2);
              });

          var rectangle = svg.append("rect")
                .attr("width", 70)
                .style("fill", "#06665D")
                .style("opacity", 0.9);

          var number = d3.select("svg").append("text")
            .attr("class", "number");
          });

        });

      // //Width and height
      // var w = 800;
      // var h = 550;

      // //Create SVG element
      // var svg = d3.select("#geo_mapping_berlin")
      //       .append("svg")
      //       .attr("width", w)
      //       .attr("height", h);

      // var color = d3.scale.quantize()
      //           .range(["rgb(255,247,188)","rgb(254,227,145)","rgb(254,196,79)","rgb(254,153,41)","rgb(236,112,20)","rgb(204,76,2)","rgb(153,52,4)","rgb(102,37,6)"]);

      // d3.csv("/data/berlin_population.csv", function(data) {

      //   var yScale = d3.scale.linear()
      //     .domain([d3.min(data, function(d) { return d.population; }), d3.max(data, function(d) { return d.population; }) ])
      //     .range([20, h/3.5]);
      //     // console.log(yScale(2))

      //   //Set input domain for color scale
      //   color.domain([
      //     d3.min(data, function(d) { return d.population; }), 
      //     d3.max(data, function(d) { return d.population; })
      //   ]);

      //   d3.json("/data/berlin.json", function(json) {
      //     //Merge the ag. data and GeoJSON
      //     //Loop through once for each ag. data value
      //     for (var i = 0; i < data.length; i++) {
        
      //       //Grab state name
      //       var dataDistrict = data[i].district;
            
      //       //Grab data value, and convert from string to float
      //       var dataPopulation = parseFloat(data[i].population);
      //       var dataLat = parseFloat(data[i].lat);
      //       var dataLon = parseFloat(data[i].lon);
        
      //       //Find the corresponding state inside the GeoJSON
      //       for (var j = 0; j < json.features.length; j++) {
            
      //         var jsonDistrict = json.features[j].properties.Name;
        
      //         if (dataDistrict == jsonDistrict) {
            
      //           //Copy the data Population into the JSON
      //           json.features[j].properties.population = dataPopulation;
      //           json.features[j].properties.lat = dataLat;
      //           json.features[j].properties.lon = dataLon;

                
      //           //Stop looking through the JSON
      //           break;
                
      //           }
      //         }
      //       }

      //     var center = d3.geo.centroid(json);
          
      //     //Tooltip div added
      //     var div_tooltip = d3.select("body").append("div")
      //       .attr("class", "tooltip_geomapping")
      //       .style("opacity", 0);



      //     //Define map projection
      //     var projection = d3.geo.mercator()
      //           .center(center)
      //           .scale([350000])
      //           .translate([w/2, h/2]);


      //     //Define path generator
      //     var path = d3.geo.path()
      //              .projection(projection);


      //     svg.selectAll("path")
      //       .data(json.features)
      //       .enter()
      //       .append("path")
      //       .attr("d", path)
      //       .style("stroke", 'white')
      //       .style("stroke-width", 2)
      //       .style("fill", function(d) {
      //         //Get data value
      //         var population = d.properties.population;
              
      //         if (population) {
      //           //If value exists…
      //           return color(population);
      //         } else {
      //           //If value is undefined…
      //           return "#ccc";
      //         }
      //       })
      //       .on("mouseover", function(d) {
      //         d3.select(this).style("stroke", "white").style("stroke-width", 5)
      //         div_tooltip
      //           .transition()
      //           .duration(200)
      //           .style("opacity", .9);
      //         div_tooltip
      //           .html("<strong>" + d.properties.Name + "</strong></br> Population:" + d.properties.population)
      //           .style("left", (d3.event.pageX) + "px")
      //           .style("top", (d3.event.pageY - 28) + "px");
      //         div_number
      //           .text(d.properties.population)
      //           .style("left", function() {
      //             return (projection([d.properties.lon, d.properties.lat])[0]) + "px";
      //             })
      //           .style("top", function() {
      //             return (projection([d.properties.lon, d.properties.lat])[1]) -180 + "px";
      //             })
      //         div_number
      //           .style("top", h)
      //           .transition()
      //           .duration(600)
      //           .style("left", function() {
      //             return (projection([d.properties.lon, d.properties.lat])[0]) + "px";
      //             })
      //           .style("top", function() {
      //             return (projection([d.properties.lon, d.properties.lat])[1]) - yScale(d.properties.population) - 18 + "px";
      //             });
      //         rectangle
      //           .attr("x", function() {
      //             // console.log("x=" + (projection([d.properties.lon, d.properties.lat])[0]))
      //             return (projection([d.properties.lon, d.properties.lat])[0]);
      //             })
      //           .attr("y", function() {
      //             console.log("y vor transition=" + (projection([d.properties.lon, d.properties.lat])[1]))
      //             console.log("y nach transition"+ ((projection([d.properties.lon, d.properties.lat])[1]) - yScale(d.properties.population)))
      //             console.log("yScale oder height =" + yScale(d.properties.population))
      //             return (projection([d.properties.lon, d.properties.lat])[1])
      //             });
      //         rectangle
      //           .attr("height", 0)
      //           .transition()
      //           .duration(600)
      //           .attr("height", function() {
      //             return yScale(d.properties.population);
      //             })
      //           .attr("y", function() {
      //             return (projection([d.properties.lon, d.properties.lat])[1]) - yScale(d.properties.population);
      //             })
      //           })
      //       .on("mouseout", function(d) {
      //         div_tooltip
      //           .transition()
      //           .duration(500)
      //           .style("opacity", 0);
      //         d3.select(this)
      //           .style("stroke", "white")
      //           .style("stroke-width", 2);
      //         });

      //     var rectangle = svg.append("rect")
      //           .attr("width", 70)
      //           .style("fill", "#06665D")
      //           .style("opacity", 0.9);

      //     var div_number = d3.select("svg").append("div")
      //       .attr("class", "number")
      //       .style("fill", "black");
      //     });
      //   });

  })()
</script>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-08-20-half-way">Half Way</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Tue 20 August, 2013, 17:00</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Half Way" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>It&#39;s the 20th of August already. That means we&#39;re already more than half way through our coding summer. As we went through our Sinatra refactoring with coach Matt this morning we realised how far we&#39;d come in the last month and a half. Apart from things being waaaay less confusing, we also seem to know the right questions to ask. Inch by inch we&#39;re making progress :-)</p>

<p><img src="/images/slinky.gif" alt="slinky"></p>

<p>The next step with our data viz project was to try and find someway of mapping zipcodes to geographical administrative regions. We found some useful data files that we were able to download at <a href="http://geonames.org">geonames.org</a> and spent the rest of the day exploring what the files contained and how we would need to handle them, and our existing data files, and mash them into something our visualisations can use.</p>

<p>Also: <a href="https://twitter.com/astellingwerff">Adriaan</a> came to visit. He had some tips for how we might set up our database and tables in it. </p>

<p><img src="/images/adriano.jpg" alt="adriano" style="width: 300px;"/></p>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-08-19-grosser">Germany ist Grosser</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Mon 19 August, 2013, 17:22</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Germany ist Grosser" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>Today we were feeling ambitious. So after finishing refactoring our Sinatra tests, we decided to take our D3 learnings and make some maps of Europe.</p>

<p>First we needed to find the <a href="http://en.wikipedia.org/wiki/Shapefile">shapefiles</a> for our chosen countries (Carla chose the Czech Republic, Anja went with Germany). We found them on the <a href="http://gadm.org/">Global Administrative Areas</a> website. </p>

<p>Then we had to convert our shapefiles into GeoJSON files, a format that D3 can work with. We did this using something called <strong>gdal</strong>, then running the <strong>ogr2ogr</strong> command on our downloaded <strong>.shp</strong> file (details of exactly how to install this software can be found in <a href="http://shop.oreilly.com/product/0636920026938.do">Interactive Data Visualization</a> on p233).</p>

<p>Once we had this the next challenge was to work out how to properly use the D3 <strong>projection</strong> function. We didn&#39;t realise it was important to pass latitude and longitude coordinates for where the centre of the map should be (in Anja&#39;s case, 50 and 10, in Carla&#39;s 48 and 15). From there, scaling and colouring the maps was easy as we could use the same code from our previous US example. </p>

<p>CRUCIALLY: We also need to wrap each of our maps in seperate functions:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">    (function() {
            *code goes here*
    })()
</code></pre></div>
<p>This helps keep any confusion with variable name conflicts in check.</p>

<p>Here is the Czech Republic, with regions in the tooltips:</p>

<div id="geo_mapping_cz" style="height: 250px;"></div>

<script type="text/javascript">
(function() {

    //Width and height
    var wcz = 620;
    var hcz = 350;

    //Easy colors accessible via a 10-step ordinal scale
    var czech_color = d3.scale.category10();

    //div set up
    var div = d3.select("body").append("div")   
      .attr("class", "tooltip_geomapping")               
      .style("opacity", 0);

    //Define map projection
    var projection = d3.geo.mercator()
    .center([15, 49])
    .scale(16000)
    .translate([wcz / 2, hcz / 2]);

    //Define path generator
    var path = d3.geo.path()
                     .projection(projection);

    //Create SVG element
    var svg = d3.select("#geo_mapping_cz")
                .append("svg")
                .attr("width", wcz)
                .attr("height", hcz);

    //Load in GeoJSON data
    d3.json("/data/CZE_adm1.json", function(json) {
        
        //Bind data and create one path per GeoJSON feature
        svg.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path)
           .style("fill", function(d, i) {
            return czech_color(i);
        })
           .style("stroke", 'rgb(256,256,256)')
            .on("mouseover", function(d) {      
          div
              .transition()        
              .duration(200)      
              .style("opacity", .9);      
          div
              .html(d.properties.NAME_1)
              .style("left", (d3.event.pageX) + "px")     
              .style("top", (d3.event.pageY - 28) + "px");    
        })                  
        .on("mouseout", function(d) {       
          div
            .transition()        
            .duration(500)      
            .style("opacity", 0);   
       });

    });
})()
</script>

<p>But Germany is bigger ;-)</p>

<div id="geo_mapping_de" style="margin-top: -160px;"></div>

<script type="text/javascript">
(function() {
    //Width and height
    var w2 = 620;
    var h2 = 800;
    var color_germany = d3.scale.category10();     //builtin range of colors
    //Define default path generator
    var path_de = d3.geo.path()
         .projection(d3.geo.mercator()
        .center([10, 52])
        .scale(16000)
        .translate([w2/2, h2/2]));
    var div = d3.select("body").append("div")
            .attr("class", "tooltip_geomapping")
            .style("opacity", 0);

    //Create SVG element
    var svg_de = d3.select("#geo_mapping_de")
                .append("svg")
                .attr("width", w2)
                .attr("height", h2);

    //Load in GeoJSON data
    d3.json("/data/country_germany_states.json", function(json) {
        
        //Bind data and create one path per GeoJSON feature
        svg_de.selectAll("path")
          .data(json.features)
          .enter()
          .append("path")
          .attr("d", path_de)
          .style("fill", function(d, i) { return color_germany(i); })
            .style("stroke", 'rgb(256,256,256)')
            .on("mouseover", function(d) {
                div
                        .transition()
                    .duration(200)
                    .style("opacity", .9);
                div
                        .html(d.properties.NAME_1)
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY - 28) + "px");
            })                  
                .on("mouseout", function(d) {
                div
                    .transition()
                .duration(500)
              .style("opacity", 0);
                });
    });
})()
</script>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-08-15-first-map">Our first Geomap</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Thu 15 August, 2013, 17:00</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Our first Geomap" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>We spent half the morning trying to get the printer driver to run and print with Anja&#39;s computer (to print our eurocamp-ticket). Well we didn&#39;t succeed. After what seemed like an hour Carla tried to print from her computer, which usually works but siehe da, the printer was out of color.
Well trolled!</p>

<p>So we don&#39;t have a printed <a href="http://2013.eurucamp.org/">eurocamp</a> ticket but we hope they&#39;ll let us in tomorrow anyway!</p>

<p>Then we went on with the book. Today we proceed with the chapter about geomapping. It gave us some really nice <a href="http://bl.ocks.org/mbostock/3711652">examples</a> of how to draw a map with d3.</p>

<p>Then we draw our first map. Coincidentally the data from the book are reports of agricultural productivity in the USA during the year 2004. Fits perfectly with our next project. This time it took only about half an hour to get the tooltips working, but we didn&#39;t get the coloring working like it should (it works on localhost but not here), grrrrrh!</p>

<div id="geo_mapping_usa" ></div>

<script type="text/javascript">

      //Width and height
      var w = 700;
      var h = 500;

      //Define map projection
      var projection = d3.geo.albersUsa()
                   .translate([w/2, h/2])
                   .scale([700]);

      //Define path generator
      var path = d3.geo.path()
               .projection(projection);

      var div = d3.select("body").append("div")
          .attr("class", "tooltip_geomapping")
          .style("opacity", 0);
               
      //Define quantize scale to sort data values into buckets of color
      var color_geo_map = d3.scale.quantize()
                .range(["rgb(237,248,233)","rgb(186,228,179)","rgb(116,196,118)","rgb(49,163,84)","rgb(0,109,44)"]);
                //Colors taken from colorbrewer.js, included in the D3 download

      //Create SVG element
      var svg = d3.select("#geo_mapping_usa")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

      //Load in agriculture data
      d3.csv("/data/us-ag-productivity-2004.csv", function(data) {

        //Set input domain for color scale
        color_geo_map.domain([
          d3.min(data, function(d) { return d.value; }), 
          d3.max(data, function(d) { return d.value; })
        ]);

        //Load in GeoJSON data
        d3.json("/data/us-states.json", function(json) {

          //Merge the ag. data and GeoJSON
          //Loop through once for each ag. data value
          for (var i = 0; i < data.length; i++) {

            //Grab state name
            var dataState = data[i].state;
            
            //Grab data value, and convert from string to float
            var dataValue = parseFloat(data[i].value);

            //Find the corresponding state inside the GeoJSON
            for (var j = 0; j < json.features.length; j++) {

              var jsonState = json.features[j].properties.name;

              if (dataState == jsonState) {

                //Copy the data value into the JSON
                json.features[j].properties.value = dataValue;

                //Stop looking through the JSON
                break;

              }
            }
          }

          //Bind data and create one path per GeoJSON feature
          svg.selectAll("path")
             .data(json.features)
             .enter()
             .append("path")
             .attr("d", path)
             .style("stroke", 'rgb(0,104,55)')
             .style("fill", function(d) {
                //Get data value
                var value = d.properties.value;

                if (value) {
                  //If value exists…
                  return color_geo_map(value);
                } else {
                  //If value is undefined…
                  return "#ccc";
                }
              })
             .on("mouseover", function(d) {
                div
                    .transition()
                    .duration(200)
                    .style("opacity", .9);
                div
                    .html(d.properties.name)
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY - 28) + "px");
              })
              .on("mouseout", function(d) {
                div
                  .transition()
                  .duration(500)
                . style("opacity", 0);
             });

        });

      });

    </script>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-08-14-Muddleheadedness">Muddleheadedness</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Wed 14 August, 2013, 16:00</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Muddleheadedness" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>We started with going through all the code we already worked with to check whether or not we understood. Luckily we had some printer paper, so printed some files out to annotate by hand. This is how it looked:</p>

<p><img src="/images/chaos.jpg" alt="chaos">
<p></p>
We were kind of able to explain all the cryptic looking code, yeay! 
Relieved we confronted our next challenge: turning a stack upside down.</p>

<p><img src="/images/stack_top.jpg" alt="stack_top">
<p></p>
After
... hours of pondering.
<p></p></p>

<p><img src="/images/stack_bottom.jpg" alt="stack_bottom">
<p></p>
The result was overwelming and worth it :)</p>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>



<!-- Pagination litransparent url('/../images/hr.png') 0 0 no-repeatnks -->
<div class="pagination">
  
    <br>
    

      
          <a href="/blog/page2" class="previous " style="padding-left:5px">Recent Posts</a>
        
    
    
    <span class="page_number " style="padding-left:25%; font-weight:normal; font-size:12px;">Page: 3 of 11</span>

     
    
      <a href="/blog/page4" class="next " style="float:right; padding-right:30px;">Earlier Posts</a>
    
  
</div>

        </section>

        <footer>
          inchworms is maintained by <a href="https://github.com/carlad">carlad</a> & <a href="https://github.com/tyranja">tyranja</a> as part of their <a href="http://railsgirlssummerofcode.org">Rails Girls Summer of Code</a> team project.<br>
          An <a href="http://inchworms.net/blog/feed.xml">RSS feed</a> is available. You can also follow inchworms on <a href="https://twitter.com/inchworms_">twitter</a>.<br> 
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.<br>
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-41825288-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

          <!-- Start of StatCounter Code for Default Guide -->
              <script type="text/javascript">
                var sc_project=9035219; 
                var sc_invisible=1; 
                var sc_security="4db3485e"; 
                var scJsHost = (("https:" == document.location.protocol) ?
                "https://secure." : "http://www.");
                document.write("<sc"+"ript type='text/javascript' src='" +
                scJsHost+
                "statcounter.com/counter/counter.js'></"+"script>");
              </script>
              <noscript>
                <div class="statcounter"><a title="web counter"
                  href="http://statcounter.com/free-hit-counter/"
                  target="_blank"><img class="statcounter"
                  src="http://c.statcounter.com/9035219/0/4db3485e/1/"
                  alt="web counter"></a></div>
            </noscript>
              <!-- End of StatCounter Code for Default Guide -->

      </div>
    </div>
  </body>
</html>
