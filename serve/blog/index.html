<!DOCTYPE html>
<html>
  <head>
    <meta name="description" content="inchworms RGSoC">
    <meta name="keywords" content="inchworms, rails girls, summer of code, open source, sinatra, farm subsidy">
    <meta name="author" content="inchworms_">
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="alternate" type="application/rss+xml" title="inchworms" href="http://inchworms.net/blog/feed.xml">
    <link rel="shortcut icon" href="/faviconStatic.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>inch by inch</title>
    <script type="text/javascript" src="/javascripts/d3.v3.js">
    </script>
    <!-- <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?2.1.3"></script> -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <a href="/blog" class="">
          <img src="http://25.media.tumblr.com/aab70fec3abd0a9a6b9f1803621aabc0/tumblr_mn2s5hgPpX1qlpk58o1_400.gif" alt="inchworm" height="84" width="100" style="position:relative; top:5px; float:right;">   
          <h1>inchworms</h1></a>
          <h2>Summer of Coding, one inch at a time...</h2>
              
        </header>
   
        <section id="main_content">
            <!-- This loops through the paginated posts -->

  <h1><a href="/blog/2013-09-09-kitchenoffice">kitchenoffice</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Mon 9 September, 2013, 15:00</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="kitchenoffice" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>Today we had to sort out a lot of things (planing the last weeks), baking a Travis cake and add a new table to our database and all in Anja&#39;s kitchen.</p>

<p><img src="/images/kitchenoffice.jpg" alt="kitchenoffice"></p>

<p>We wrote a new migration:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Sequel.migration do
  change do
    create_table(:payment_year_totals) do
      primary_key :id
      BigDecimal :amount_euro
      foreign_key(:year_id, :years)
      foreign_key(:recipient_id, :recipients)
    end
  end
end
</code></pre></div>
<p>and a rake task:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">task :run_any_new_migration do
    require &quot;sequel&quot;
    Sequel.extension :migration

    DB = Sequel.postgres(&quot;farmsubsidy_performance&quot;)
    Sequel::Migrator.run(DB, &#39;./db/migrations&#39;, :use_transactions=&gt;true)
end
</code></pre></div>
<p>and ruby code to populate it:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">require &#39;rubygems&#39;
require &#39;sequel&#39;
require &#39;logger&#39;


# connect to an in-memory database
DB = Sequel.postgres(&quot;farmsubsidy_performance&quot;, :loggers =&gt; [Logger.new($stdout)])

# connect to the models
project_root = File.dirname(File.absolute_path(__FILE__))
Dir.glob(project_root + &quot;/models/*.rb&quot;).each{|f| require f}

# connect to payments total table and add data to the database
total_payment = DB[:payment_year_totals]

# look through all recipients and all years and insert the total amount
Recipient.all.each do |recipient|
  Year.all.each do |year|
    total = recipient.total_payment_amount_by_year(year.year)
    #make sure the total isn&#39;t 0
    if total != 0.0
      total_payment.insert(
        recipient_id: recipient.id,
        year_id: year.id,
        amount_euro: total
        )
    end
  end
end
</code></pre></div>
<p>and now we have a new database with all the recipients and the total payment per year. Yeah!</p>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-09-05-upgrade">Upgrade</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Thu 5 September, 2013, 18:04</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Upgrade" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>Steps to upgrade your HDD to an SSD:</p>

<ul>
<li>prepare a bootable USB drive with Ubuntu system on it (instructions available on Ubuntu website)</li>
<li>get rid of everything you don&#39;t want on your current drive (including Google Chrome caches)</li>
<li>empty the trash</li>
<li>log out of the graphical interface</li>
<li>change to a text console (ctrl + alt + F1)</li>
<li>login with username and sudo password</li>
<li>switch to root user (<strong>$ sudo -i</strong>)</li>
<li>find out how big the home folder is (<strong># du -sh/home/username</strong>)</li>
<li>find all the disks on the machine and their usage (<strong># df -h</strong>)</li>
<li>go to home directory (<strong># cd /home</strong>)</li>
<li>check present working directory (<strong># pwd</strong>)</li>
<li>check what is in directory (<strong># ls</strong>)</li>
<li>zip the folder (<strong># tar czvf backup_home.tgz username/</strong>)</li>
<li>if the screen goes black at any stage during the compression press the SHIFT key to wake the screen up</li>
<li>once the archive is complete copy this to an external drive</li>
<li>ctrl + d to exit the root user</li>
<li>ctrl + d to exit the text console session</li>
<li>shut down the computer</li>
<li>take out the old HDD (making note of orientation as you pull it out)</li>
<li>unscrew HDD from casing and put SSD drive in casing</li>
<li>put SSD drive into computer</li>
<li>put bootable USB w Ubuntu install into USB port</li>
<li>start computer (you may need to enter BIOS to configure computer to boot from USB drive)</li>
<li>follow instructions to install Ubuntu from USB drive</li>
<li>once installed log in</li>
<li>log out</li>
<li>restart computer (remove USB drive when computer is off and before it restarts)</li>
<li>log in and check for system updates</li>
<li>download and install updates</li>
<li>restart</li>
<li>put your old HDD into the USB casing you purchased when buying your SSD</li>
<li>if your HDD and new SSD drive have the same version of Ubuntu you can copy the contents of your old home directory directly to your new home directory</li>
<li>plug the HDD drive into a USB port</li>
<li>log out of graphical interface</li>
<li>open text console and log in</li>
<li>become root user (<strong>$ sudo -i</strong>)</li>
<li>navigate to home directory (<strong># cd /home</strong>)</li>
<li>check the <username> of home folder to rename (<strong># ls</strong>)</li>
<li>move username folder to new folder(<strong># mv username ssd_username</strong>)</li>
<li>find location of old HHD home folder</li>
<li>sync home username folder on HDD with home username folder on SSD</li>
<li><strong># rsync -Pav path-to-old-home-folder name-of-new-home-folder</strong></li>
<li>then sudo install git and curl</li>
<li>install rvm</li>
<li>sudo install postgres 

<ul>
<li><strong>sudo apt-get install postgresql</strong></li>
<li><strong>sudo -u postgres createuser --superuser $USER</strong></li>
<li><strong>sudo apt-get install libpq-dev</strong></li>
</ul></li>
<li>install whatever other applications and configurations you were using before (if they haven&#39;t been saved in your original home folder)</li>
</ul>

<p>Viola!! Watch your databases populate a squillion times faster :-)</p>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-09-04-sequel-models">Sequel Models</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Wed 4 September, 2013, 17:11</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Sequel Models" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>Today we created model classes for each of our database tables. It was way easier than we expected and required just a single line: <strong>class Year &lt; Sequel::Model; end</strong>. Sometimes reading the documentation yields quicker-than-expected results!!</p>

<p>Then, after adding associations between the classes (such as <strong>one-to-many :recipients</strong>) we were able to dig around our dataset objects and look at (for example) what methods were available to what objects. <strong>payments_sorted.all.first.values.methods</strong> returned a different list of available methods to <strong>payments_sorted.all.methods</strong>.</p>

<p>We also worked out how to see what columns an object contained, and how to add a new key/value combination to it. </p>

<p>Tomorrow we&#39;re both installing SSDs into our laptops. This <em>may</em> mean our computers will be out-of-action at the end of the day, so we may not be able to post here tomorrow...</p>

<p><img src="/images/ssd.jpg" alt="ssd"></p>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-09-02-shoving">The Technique of Shoving</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Mon 2 September, 2013, 17:11</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="The Technique of Shoving" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>Today we continued working with our test data, making decisions about what we wanted to show and the data structure we would need to build. Our first objective was to show a bar chart of the top 20 subsidy recipients by year.</p>

<p>First step: retrieve the relevant data and &quot;shove&quot; it into a ruby hash.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">    require &#39;csv&#39;
    require &#39;rubygems&#39;
    require &#39;sequel&#39;
    require &#39;logger&#39;

    # top_payments will be an aray of hashes with the final results
    # eg [{rank: 1, name: &quot;horst&quot;, amount: 234556}, {...}]
    top_payments = []

    # connect to an in-memory database
    DB = Sequel.postgres(&quot;farmsubsidy_performance&quot;, :loggers =&gt; [Logger.new($stdout)])

    #select a year between 2004 and 2011
    p &quot;Select a year between 2004 and 2011:&quot;
    year_selection = gets

    # find the year_id from the years table
    year_id = DB[:years].where(year: year_selection.to_i).first[:id]

    # find payments by year, order them by amount, and return the first 20
    payments_sorted = DB[:payments].where(year_id: year_id).reverse_order(:amount_euro).limit(20)

    # find recipient name, create an index, shove it into top_payments hash
    payments_sorted.each_with_index do |payment, index|
        recipient_name = DB[:recipients].where(id: payment[:recipient_id]).first[:name].gsub(&quot;\&quot;&quot;, &quot;&quot;)
        top_payments &lt;&lt; {rank: index+1, name: recipient_name, amount: payment[:amount_euro]}
    end

    p top_payments
</code></pre></div>
<p>Then, use the hash to create a CSV file.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">    CSV.open(&quot;top_payments.csv&quot;, &quot;w&quot;, :force_quotes =&gt; true) do |csv|
      i = 0
      csv &lt;&lt; [&quot;rank&quot;,&quot;name&quot;,&quot;amount&quot;]
      while i &lt; top_payments.length
        csv &lt;&lt; [top_payments[i][:rank],top_payments[i][:name],top_payments[i][:amount].to_i]
        i += 1
      end
    end
</code></pre></div>
<p>Finally, write some <a href="https://github.com/inchworms/farmsubsidy/blob/master/index.html">d3 code</a> to parse the csv file and display the data like this:</p>

<p><img src="/images/czech_bar.png" alt="horizontal_bar"></p>

<p>It made us feel like this:</p>

<p><img src="/images/dancing.gif" alt="dancing"></p>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>

  <h1><a href="/blog/2013-09-01-without-you">Can We Live Without You?</a></h1>
  <p class="meta">
      
          <a href='http://twitter.com/inchworms_'>inchworms</a> - 
        
    <span class="date">Sun 1 September, 2013, 17:50</span>
    <span style="float:right" ><a href="https://twitter.com/share" class="twitter-share-button" data-text="Can We Live Without You?" data-via="inchworms_" data-hashtags="rgsoc" data-count="none">Tweet</a></span>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
  <div class="content">
    <p>Today we moved from the 5th floor offices of <a href="https://twitter.com/travisci">TravisCI</a> to the 5th floor offices of <a href="https://twitter.com/co_up">Co-Up</a>. We cried, but not from all the stairs we had to climb. We cried because we didn&#39;t wanna say goodbye :-(</p>

<p><img src="http://24.media.tumblr.com/tumblr_m87b30INY21r0uywso1_500.gif" alt="crying"></p>

<p>But, as they say, when one door closes, another one opens. Pretty soon our new desk was set up, our coach Urs had assigned us several challenging tasks, and, along with Urs&#39; colleague Adam, shared a delicious salad for lunch.</p>

<p><img src="/images/before.jpg" alt="before">
<img src="/images/after.jpg" alt="after"></p>

<p>Mostly today was spent working on setting up a rake task that would create a seperate database we will use to test the performance of our data viz appliaction. Because we wanted our rake task to: look for a performance test database, delete it if there was one, then/or create a new performance test database - we had to work out how we could access (unix) system commands and which ones would return something we could use to check the presence of the performance test db. This took AGES.</p>

<p>Tomorrow we&#39;re going to look at caching the contents of one of our (small) tables locally to improve performance further.</p>

    <img src="/../images/hr.png" style="50% 0 no-repeat">
  </div>
    <p></p>



<!-- Pagination litransparent url('/../images/hr.png') 0 0 no-repeatnks -->
<div class="pagination">
  
    <br>
    
      <span class="previous" style="padding-left:5px">Recent Posts</span>
    
    
    <span class="page_number " style="padding-left:25%; font-weight:normal; font-size:12px;">Page: 1 of 11</span>

     
    
      <a href="/blog/page2" class="next " style="float:right; padding-right:30px;">Earlier Posts</a>
    
  
</div>

        </section>

        <footer>
          inchworms is maintained by <a href="https://github.com/carlad">carlad</a> & <a href="https://github.com/tyranja">tyranja</a> as part of their <a href="http://railsgirlssummerofcode.org">Rails Girls Summer of Code</a> team project.<br>
          An <a href="http://inchworms.net/blog/feed.xml">RSS feed</a> is available. You can also follow inchworms on <a href="https://twitter.com/inchworms_">twitter</a>.<br> 
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.<br>
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-41825288-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

          <!-- Start of StatCounter Code for Default Guide -->
              <script type="text/javascript">
                var sc_project=9035219; 
                var sc_invisible=1; 
                var sc_security="4db3485e"; 
                var scJsHost = (("https:" == document.location.protocol) ?
                "https://secure." : "http://www.");
                document.write("<sc"+"ript type='text/javascript' src='" +
                scJsHost+
                "statcounter.com/counter/counter.js'></"+"script>");
              </script>
              <noscript>
                <div class="statcounter"><a title="web counter"
                  href="http://statcounter.com/free-hit-counter/"
                  target="_blank"><img class="statcounter"
                  src="http://c.statcounter.com/9035219/0/4db3485e/1/"
                  alt="web counter"></a></div>
            </noscript>
              <!-- End of StatCounter Code for Default Guide -->

      </div>
    </div>
  </body>
</html>
